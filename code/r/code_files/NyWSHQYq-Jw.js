if (self.CavalryLogger) { CavalryLogger.start_js(["EVd0C"]); }

__d("MLogoutClearCache",["MCache","Stratcom"],(function a(b,c,d,e,f,g,h,i){i.listen("click","logout",h.clear)}),null);
__d("isLinkshimURI",["isBonfireURI","isFacebookURI","isMessengerDotComURI"],(function a(b,c,d,e,f,g,h,i,j){"use strict";function k(l){var m=l.getPath();if((m==="/l.php"||m.indexOf("/si/ajax/l/")===0||m.indexOf("/l/")===0||m.indexOf("l/")===0)&&(i(l)||j(l)||h(l)))return true;return false}f.exports=k}),null);
__d("KaiOSController",["Promise","EventEmitter","Map","MViewport","Stratcom","URI","getActiveElement","isLinkshimURI"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";var p="app://m.facebook.com",q="callback_id",r="action",s="payload",t={APP_INFO:"app_info"},u={OPEN_URL:"open_url",REGISTER_PUSH:"register_push",UNREGISTER_PUSH:"unregister_push",SCREEN_ORIENTATION_LOCK:"screen_orientation_lock"},v=new j(),w=null,x=null,y=new h(function(J,K){x=J}),z=false,A=false,B=false;function C(J){if(w&&J)w.postMessage(J,"*")}function D(J){if(!(J instanceof j))return;var K=J.get(r),L=J.get(s),M=J.get(q);if(M){var N=v.get(M);if(N){v["delete"](M);N(L)}return}switch(K){case t.APP_INFO:if(L&&L.get){I.appVersion=L.get("app_version");if(z)window.addEventListener("click",E,true);window.addEventListener("keydown",G,false);if(A)window.addEventListener("fullscreenchange",H,false);l.listen("click",["m-composer","composer-submit"],function(O){setTimeout(function(){var P=n();if(P==O.getNode("composer-submit"))P.blur()},100)})}break}}function E(J){var K=J.target,L=null;if(K&&K.tagName==="A")L=K.href;else if(K&&K.parentElement&&K.parentElement.tagName==="A")L=K.parentElement.href;else if(K&&K.parentElement&&K.parentElement.parentElement&&K.parentElement.parentElement.tagName==="A")L=K.parentElement.parentElement.href;var M=new m(L),N=B?L!=null&&L!=="":L!=null,O=N&&!/\.facebook.com$/i.test(M.getDomain());if(L!=null&&(o(M)||O)){I.openUrl(L);J.preventDefault();J.stopPropagation()}}function F(){var J=location.href.split("/");return J.length==4&&J[3]==""}function G(event){switch(event.key){case"Backspace":case"BrowserBack":if(document.fullscreenElement){document.exitFullscreen();event.preventDefault();event.stopPropagation()}else if(!F()){history.back();event.preventDefault();event.stopPropagation()}else if(k.getScrollTop()>0){k.scrollTo(0,0);event.preventDefault();event.stopPropagation()}break}}function H(event){if(document.fullscreenElement){if(document.fullscreenElement.nodeName=="VIDEO")if(screen.orientation)screen.orientation.lock("landscape")}else{var J=new j(),K=new j();J.set(r,u.SCREEN_ORIENTATION_LOCK);J.set(s,K);K.set("orientation","portrait");C(J)}}var I={appVersion:null,init:function J(K){z=!!K.get("open_links_in_app");A=!!K.get("landscape_video");B=!!K.get("external_url_check");window.addEventListener("message",I.receiveMessage,false)},waitForKaiOS:function J(){return y},registerPush:function J(K){var L=Math.random().toString();v.set(L,K);var M=new j();M.set(r,u.REGISTER_PUSH);M.set(q,L);C(M)},unregisterPush:function J(){I.waitForKaiOS().done(function(){var K=new j();K.set(r,u.UNREGISTER_PUSH);C(K)})},openUrl:function J(K){var L=new j(),M=new j();L.set(r,u.OPEN_URL);L.set(s,M);M.set("url",K);C(L)},receiveMessage:function J(event){if(!event||p!=event.origin||!event.source)return;if(x){x();x=null}if(!w){w=event.source;C("received")}if(event.data)D(event.data)}};f.exports=I}),null);
__d("BrowserPushCommands",[],(function a(b,c,d,e,f,g){var h="browser_push_ack",i="browser_push_redirect",j="browser_push_window_visible",k={ACK:h,REDIRECT:i,WINDOW_VISIBLE:j};f.exports=k}),null);
__d("BrowserPushMessageRedirectUtil",[],(function a(b,c,d,e,f,g){var h=function h(i){return true};f.exports=h}),null);
__d("BrowserPushMessageHandler",["BrowserPushCommands","BrowserPushMessageRedirectUtil","EventListener","URI","URISchemes","isFacebookURI"],(function a(b,c,d,e,f,g,h,i,j,k,l,m){function n(event){if(event.data.command&&event.data.command===h.REDIRECT){if(window.onbeforeunload()===undefined)event.ports[0].postMessage({command:h.ACK,success:true});else{event.ports[0].postMessage({command:h.ACK,success:false});return}var p=event.data.uri;if(/^([^.:/?#]+):/.test(p)&&!l.isAllowed(/^([^.:/?#]+):/.exec(p)[1])||!m(new k(p)))throw new Error("goURI: URI scheme rejected, URI: "+p);if(i(p))window.location.href=p}}var o={registerRedirectHandler:function p(){j.listen(window,"message",function(event){if(event.origin==="")n(event)});if(navigator.serviceWorker&&navigator.serviceWorker.addEventListener)navigator.serviceWorker.addEventListener("message",function(event){if(navigator.serviceWorker&&navigator.serviceWorker.controller&&event.target&&event.target.controller&&event.target.controller===navigator.serviceWorker.controller||new RegExp("^"+window.location.protocol+"//"+window.location.host+"$").test(event.origin))n(event)})}};f.exports=o}),null);
__d("BrowserPushVisibilityChanger",["BrowserPushCommands","ClientServiceWorkerMessage","Visibility"],(function a(b,c,d,e,f,g,h,i,j){function k(){new i(h.WINDOW_VISIBLE,null).sendViaController()}var l={listenForVisibility:function m(){if(!j.isHidden())k();j.addListener(j.VISIBLE,k)}};f.exports=l}),null);
__d("PushRegistration",["Promise","BrowserPushMessageHandler","BrowserPushVisibilityChanger","Map","ServiceWorkerRegistration","emptyFunction"],(function a(b,c,d,e,f,g,h,i,j,k,l,m){var n=window.Notification,o=new k();p.get=function(q,r){"use strict";if(o.has(r))return o.get(r);var s=new p(q,r);o.set(r,s);return s};function p(q,r){"use strict";this.$PushRegistration3=q;this.appID=r;if(!p.$PushRegistration1&&!p.$PushRegistration2){p.$PushRegistration1=false;p.$PushRegistration2=false}}p.prototype.getPushSubscription=function(){"use strict";return new h(function(q,r){if(p.pushPermissionIsDenied())r(new Error("No permission or not supported"));l.getWorkerRegistration(this.$PushRegistration3).then(function(s){if(!s){q(null);return}s.pushManager.getSubscription().then(function(t){q(t)})["catch"](r)})["catch"](r)}.bind(this))};p.prototype.$PushRegistration4=function(q){"use strict";var r=q.endpoint;if("subscriptionId"in q&&!new RegExp("/"+q.subscriptionId+"$").test(r))r+="/"+q.subscriptionId;return r};p.prototype.$PushRegistration5=function(q,r,s,t){"use strict";var u=this.$PushRegistration4(s),v=q.getURIBuilder().getURI(),w=new r(v),x=null;if(s.toJSON)x=s.toJSON().keys;else if(s.keys)x=s.keys;w.setData({app_id:this.appID,push_endpoint:u,subscription_keys:JSON.stringify(x)});w.setMethod("post");if(w.setHandler)w.setHandler(function(y){if(y.payload&&y.payload.session_change)t()});w.send()};p.prototype.getSubscription=function(){"use strict";return new h(function(q,r){this.getPushSubscription().then(function(s){if(s)q(this.$PushRegistration4(s));else q(null)}.bind(this))["catch"](r)}.bind(this))};p.prototype.maybeRegisterPushAgain=function(q,r,s){"use strict";return new h(function(t,u){this.getPushSubscription().then(function(v){if(v){this.$PushRegistration5(q,r,v,s);t(this.$PushRegistration4(v))}else t(null)}.bind(this))["catch"](function(){t(null)})}.bind(this))};p.prototype.$PushRegistration6=function(q,r,s){"use strict";return new h(function(t,u){if(p.$PushRegistration2&&!s){u(new Error("sending disable info already"));return}p.$PushRegistration2=true;var v=q.getURIBuilder().getURI(),w=new r(v.toString());w.setData({appid:this.appID,from_browser_settings:s});w.setMethod("post");if(w.listen){w.listen("finally",t);w.listen("fail",function(){p.$PushRegistration2=false;u()})}else if(w.setErrorHandler&&w.setHandler){w.setErrorHandler(function(){p.$PushRegistration2=false;u()});w.setHandler(t)}else t();w.send()}.bind(this))};p.prototype.isPushRegistered=function(q,r,s,t){var u=arguments.length<=4||arguments[4]===undefined?false:arguments[4],v=arguments.length<=5||arguments[5]===undefined?m:arguments[5],w=arguments.length<=6||arguments[6]===undefined?false:arguments[6];"use strict";i.registerRedirectHandler();return new h(function(x,y){this.getPushSubscription().then(function(z){x(!!z||q&&!p.pushPermissionIsPending());if(z)if(u)self.$PushRegistration5(r,t,v,w);else j.listenForVisibility();else if(!z&&q)if(p.pushPermissionIsOn())this.registerPush(r,t,v,w)["catch"](function(){});else this.$PushRegistration6(s,t,false)}.bind(this))["catch"](function(){if(q)this.$PushRegistration6(s,t,false);if(w)l.unregisterControllingWorker();y()}.bind(this))}.bind(this))};p.prototype.$PushRegistration7=function(){"use strict";return new h(function(q,r){n.requestPermission(q)})};p.prototype.registerPushAndWaitForEndpoint=function(q,r,s,t){"use strict";return new h(function(u,v){this.$PushRegistration8(q,r,s,true,null,t).then(function(w){if(typeof w!=="string"){v(new Error("registerPushImpl did not return an endpoint"));return}u(w)})["catch"](v)}.bind(this))};p.prototype.registerPushOnKaiOS=function(q,r,s){"use strict";return new h(function(t,u){s.waitForKaiOS().done(function(){s.registerPush(function(v){var w=JSON.parse(v.get("push_endpoint"));this.$PushRegistration5(q,r,w,m);t(this.$PushRegistration4(w))}.bind(this))}.bind(this))}.bind(this))};p.prototype.registerPush=function(q,r){var s=arguments.length<=2||arguments[2]===undefined?m:arguments[2],t=arguments.length<=3||arguments[3]===undefined?false:arguments[3];"use strict";return this.registerPushWithFinishedCallBack(q,r,s,null,t)};p.prototype.registerPushWithFinishedCallBack=function(q,r,s,t,u){"use strict";return new h(function(v,w){this.$PushRegistration8(q,r,s,false,t,u).then(function(x){if(typeof x!=="boolean"){w(new Error("registerPushImpl did not return a boolean"));return}v(x)})["catch"](w)}.bind(this))};p.prototype.$PushRegistration8=function(q,r,s,t,u,v){"use strict";if(p.$PushRegistration1)return new h(function(w,x){x(new Error("registering already"))});if(!self.PushManager)return h.reject(new Error("PushManager not found."));p.$PushRegistration1=true;return new h(function(w,x){var y=l.registerWorkerIfUnregistered(this.$PushRegistration3),z=this.$PushRegistration7();h.all([y,z]).then(function(A){var B=A[0];if(!p.pushPermissionIsOn()){if(v)B.unregister();throw new Error("Push permission was denied")}if(!t)w(true);B.pushManager.subscribe({userVisibleOnly:true}).then(function(C){if(t)w(this.$PushRegistration4(C));this.$PushRegistration5(q,r,C,s);if(u)u();j.listenForVisibility()}.bind(this))["catch"](function(C){p.$PushRegistration1=false;if(v)B.unregister();x(C)})}.bind(this))["catch"](function(A){p.$PushRegistration1=false;x(A)})}.bind(this))};p.prototype.unregisterPushAndSWOnKaiOS=function(q,r,s,t){"use strict";return new h(function(u,v){this.$PushRegistration6(q,r,t).then(function(){s.unregisterPush();u()})["catch"](v)}.bind(this))};p.prototype.unregisterPushAndSW=function(q,r){"use strict";return new h(function(s,t){this.$PushRegistration6(q,r,true).then(function(){l.unregisterControllingWorker().done(s)})["catch"](t)}.bind(this))};p.prototype.unregisterPushOnly=function(q,r){"use strict";return new h(function(s,t){this.getPushSubscription().then(function(u){if(u)u.unsubscribe().then(this.$PushRegistration6(q,r,true)).then(function(){s(true)})["catch"](t);else t()}.bind(this))["catch"](t)}.bind(this))};p.pushPermissionIsPending=function(){"use strict";return window.Notification&&window.Notification.permission==="default"};p.pushPermissionIsOn=function(){"use strict";return window.Notification&&window.Notification.permission==="granted"};p.pushPermissionIsDenied=function(){"use strict";return window.Notification&&window.Notification.permission==="denied"};f.exports=p}),null);
__d("XBrowserPushXOutController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/notifications/client/push/xout/",{})}),null);
__d("XPushRegisterServiceWorkerController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/push/register/service_worker/",{})}),null);
__d("MNotificationsPushInstall",["Promise","BanzaiLogger","KaiOSController","MobileAppDetect","MRequest","PushRegistration","Stratcom","XBrowserPushXOutController","XPushRegisterServiceWorkerController"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(event,s,t){var u={event:event,appid:s,surface:t};i.log("BrowserPushLoggerConfig",u)}var r={installHandler:function s(t,u){q("turn_on",t.appID,u);var v=void 0;if(k.is_kaios)v=t.registerPushOnKaiOS(p,l,j);else{if(m.pushPermissionIsPending())n.invoke("m:notifications:push:install:showCurtain");v=t.registerPush(p,l,function(){},true)}return new h(function(w,x){v.then(function(){n.invoke("m:notifications:push:install:hideCurtain");q("install",t.appID,u);w(true);n.invoke("m:notifications:push:install:installed");return})["catch"](function(y){n.invoke("m:notifications:push:install:hideCurtain");if(window.Notification&&window.Notification.permission==="denied")q("deny",t.appID,u);else q("install_ignore",t.appID,u);n.invoke("m:notifications:push:install:notInstalled");x(y);return})})},xoutHandler:function s(t,u){return new h(function(v,w){q("xout",t.appID,u);var x=o.getURIBuilder().getURI(),y=new l(x);y.setMethod("post");y.listen("finally",v);y.listen("fail",w);y.send()})}};f.exports=r}),null);
__d("XBrowserPushDisabledController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/notifications/client/push/disabled/",{})}),null);
__d("MNotificationsDirectPrompt",["MNotificationsPushInstall","MobileAppDetect","MRequest","PushRegistration","XBrowserPushDisabledController","XPushRegisterServiceWorkerController"],(function a(b,c,d,e,f,g,h,i,j,k,l,m){var n={install:function o(p,q,r,s,t){var u=k.get(p,q);if(i.is_kaios){if(!r&&!s)h.installHandler(u,"prompt");return}u.isPushRegistered(r,m,l,j,t,function(){},true).then(function(v){if(!v&&!s)h.installHandler(u,"prompt")["catch"](function(){h.xoutHandler(u,"prompt")})})["catch"](function(){})}};f.exports=n}),null);
__d("MNotificationsPushInstallCurtain",["CSS","Stratcom"],(function a(b,c,d,e,f,g,h,i){var j="upsell_curtain",k=null;function l(){if(k instanceof HTMLElement)h.show(k);i.listen("click",j,m)}function m(){if(k instanceof HTMLElement)h.hide(k)}var n={startListening:function o(p){k=p;i.listen("m:notifications:push:install:showCurtain",null,l);i.listen("m:notifications:push:install:hideCurtain",null,m)}};f.exports=n}),null);
__d("ServiceWorkerLoginAndLogout",["ClientServiceWorkerMessage"],(function a(b,c,d,e,f,g,h){function i(k){new h(k,null).sendViaController()}var j={login:function k(){i("login")},logout:function k(){i("logout")}};f.exports=j}),null);
__d("ServiceWorkerLoginAndLogoutListener",["KaiOSController","MobileAppDetect","MRequest","PushRegistration","Stratcom","ServiceWorkerLoginAndLogout","XBrowserPushDisabledController"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n){var o={listen:function p(q,r,s,t){l.listen("click",q,function(){if(i.is_kaios){if(!t)return;var u=k.get(s,t);u.unregisterPushAndSWOnKaiOS(n,j,h,false)}else if(r==="login")m.login();else if(r==="logout")m.logout();else throw new Error("bad login type given")})}};f.exports=o}),null);
__d("MBackButton",["Stratcom"],(function a(b,c,d,e,f,g,h){var i=false,j=function j(){if(i)return;i=true;h.listen("click","back-button",function(event){if(history.length>1){event.prevent();history.go(-1)}})};g.main=j}),null);