if (self.CavalryLogger) { CavalryLogger.start_js(["eUqHF"]); }

__d("ViewableImpressionUtils",[],(function a(b,c,d,e,f,g){var h={isHorizontallyOffscreen:function i(j,k,l){var m=Math.max(k.x,0),n=Math.min(k.x+k.width,l.width);return n-m<k.width}};f.exports=h}),null);
__d("VisibilityTrackingHelper",["MViewport","Stratcom","StratcomManager"],(function a(b,c,d,e,f,g,h,i,j){var k={getEventListeners:function l(m){j.enableDispatch(document,"scroll");return[i.listen("m:root:render",null,m),i.listen("scroll",null,m),i.listen("MScrollArea:scrollend",null,m)]},getViewportInfo:function l(){return{width:h.getWidth(),height:h.getHeight()}}};f.exports=k}),null);
__d("FullViewLogger",["Banzai","ScriptPath","SubscriptionsHandler","URI"],(function a(b,c,d,e,f,g,h,i,j,k){l.logFromViewableImpressionTracker=function(m){"use strict";var n=new l();n.subscribeToTrackerEvents(m)};l.prototype.subscribeToTrackerEvents=function(m){"use strict";this.subscriptionsHandler=new j();this.subscriptionsHandler.addSubscriptions(m.addListener("full_view",this.onFullView,this))};l.prototype.onFullView=function(m){"use strict";if(this.$FullViewLogger1())this.$FullViewLogger2(m);var n={token:m.token,fullViewType:m.fullViewType,scriptPath:i.getTopViewEndpoint()};h.post("xtrackable:full_view",n);if(this.$FullViewLogger1())this.$FullViewLogger3(n)};l.prototype.$FullViewLogger1=function(){"use strict";return 0};l.prototype.$FullViewLogger2=function(m){"use strict"};l.prototype.$FullViewLogger3=function(m){"use strict"};function l(){"use strict"}f.exports=l}),null);
__d("BrowseClientEventLogger",[],(function a(b,c,d,e,f,g){var h={maybeLogClientViewEvent:function i(j){},maybeLogVisiblityEvent:function i(j){}};f.exports=h}),null);
__d("CommercialBreakMobileEvent",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({SUBSCRIPTION_SUCCESS:"commercial_break_skywalker_subscription_success",SUBSCRIPTION_FAILURE:"commercial_break_skywalker_subscription_failure",RECEIVE_INTENT_MSG:"commercial_break_skywalker_receive_intent",RECEIVE_START_MSG:"commercial_break_skywalker_receive_start",RECEIVE_INVALID_MSG:"commercial_break_skywalker_receive_invalid_message",VIDEO_FETCH_SUCCESS:"commercial_break_video_fetch_success",VIDEO_FETCH_FAILURE:"commercial_break_video_fetch_failure",COMMERCIAL_BREAK_INLINE_TO_FULLSCREEN:"commercial_break_inline_to_fullscreen",COMMERCIAL_BREAK_FULLSCREEN_TO_INLINE:"commercial_break_fullscreen_to_inline",COMMERCIAL_BREAK_SCROLLED_AWAY:"commercial_break_scrolled_away",COMMERCIAL_BREAK_SCROLLED_INTO:"commercial_break_scrolled_into",COMMERCIAL_BREAK_START_NFX:"commercial_break_start_nfx",COMMERCIAL_BREAK_HIDE_AD:"commercial_break_hide_ad",COMMERCIAL_BREAK_HIDE_AD_BREAKS:"commercial_break_hide_ad_breaks",COMMERCIAL_BREAK_START:"commercial_break_start",COMMERCIAL_BREAK_START_AD:"commercial_break_start_ad",COMMERCIAL_BREAK_TRANSIT:"commercial_break_transit",COMMERCIAL_BREAK_WAIT_FOR:"commercial_break_wait_for",COMMERCIAL_BREAK_STATIC_COUNTDOWN:"commercial_break_static_countdown",COMMERCIAL_BREAK_END:"commercial_break_end",COMMERCIAL_BREAK_PAUSE_AD:"commercial_break_pause_ad",COMMERCIAL_BREAK_PLAY_AD:"commercial_break_play_ad",COMMERCIAL_BREAK_NO_AD_TRANSITION:"commercial_break_no_ad_transition",COMMERCIAL_BREAK_ELIGIBLE_VOD_START:"commercial_break_eligible_vod_start",COMMERCIAL_BREAK_START_SHOW_NOTHING:"commercial_break_start_show_nothing",COMMERCIAL_BREAK_STARTING_INDICATOR:"commercial_break_starting_indicator",COMMERCIAL_BREAK_START_TIME_DELTA:"commercial_break_start_time_delta",COMMERCIAL_BREAK_IMPRESSION_ATTEMPT:"commercial_break_impression_attempt",COMMERCIAL_BREAK_SKYWALKER_RECEIVED_DUPLICATE_EVENT:"commercial_break_skywalker_received_duplicate_event",COMMERCIAL_BREAK_ADS_LOADED:"commercial_break_ads_loaded",COMMERCIAL_BREAK_FIRE_EVENT_IN_TRACKER:"commercial_break_fire_event_in_tracker",COMMERCIAL_BREAK_LOG_IMPRESSION_IN_TRACKER:"commercial_break_log_impression_in_tracker",COMMERCIAL_BREAK_REGISTER_VIDEO:"commercial_break_register_video",COMMERCIAL_BREAK_RESUME_HOST_VIDEO:"commercial_break_resume_host_video",COMMERCIAL_BREAK_CLICK_ON_STARTING_INDICATOR:"commercial_break_click_on_starting_indicator",COMMERCIAL_BREAK_PLUGIN_IS_ON_DIFFERENT_HOSTVIDEO:"commercial_break_plugin_is_on_different_hostvideo",COMMERCIAL_BREAK_LOG_AD_IMPRESSION:"commercial_break_log_ad_impression",COMMERCIAL_BREAK_CLICK:"commercial_break_click",COMMERCIAL_BREAK_SCRUB_THROUGH:"commercial_break_scrub_through",COMMERCIAL_BREAK_SCRUBBER_LEAVE_BEFORE_AD_BREAK:"commercial_break_scrubber_leave_before_ad_break",COMMERCIAL_BREAK_SCRUBBER_LEAVE_DURING_AD_BREAK:"commercial_break_scrubber_leave_during_ad_break"})}),null);
__d("FullViewType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ENTIRE_UNIT:1})}),null);
__d("NonBlockingIFrame",["Promise","DOM","TimeSlice"],(function a(b,c,d,e,f,g,h,i,j){var k={},l,m;function n(){var q=arguments.length<=0||arguments[0]===undefined?k:arguments[0],r=arguments.length<=1||arguments[1]===undefined?document.body:arguments[1],s,t={className:"nonBlockingIframe",width:0,height:0,frameborder:0,scrolling:"no","aria-hidden":"true"};if(q!==k)t.src=q;s=i.create("iframe",t);s.style.left="-1000px";s.style.position="absolute";i.appendContent(r,s);if(q===k){s.contentDocument.open();s.contentDocument.close()}return s}function o(){return new h(function(q){if(!l)l=n();if(l.contentDocument.readyState==="complete")q(l);else{if(!m)m=new h(function(q){l.contentWindow.onload=j.guard(function(){q(l)},"NonBlockingIFrame window.onload")});q(m)}})}var p={loadImage:function q(r){return o().then(function(s){return new h(function(t,u){var v=s.contentWindow.Image,w=new v();w.onload=j.guard(function(){t(w)},"NonBlockingIFrame image.onload");w.onerror=j.guard(function(){u(w)},"NonBlockingIFrame image.onerror");w.onabort=j.guard(function(){u(w)},"NonBlockingIFrame image.onabort");w.src=r})})},loadIFrame:function q(){var r=arguments.length<=0||arguments[0]===undefined?k:arguments[0];return o().then(function(s){var t=s.contentDocument.body;return n(r,t)})}};f.exports=p}),null);
__d("PercentVisible",[],(function a(b,c,d,e,f,g){f.exports={NO_VISIBLE:-1,VISIBLE_0_PCT:0,VISIBLE_50_PCT:50,VISIBLE_100_PCT:100}}),null);
__d("VisibilityState",[],(function a(b,c,d,e,f,g){"use strict";f.exports={TOP:"TOP",BOTTOM:"BOTTOM",FULL:"FULL",NULL:"NULL"}}),null);
__d("ViewableImpressionTracker",["AdImpressionLoggingConfig","Banzai","BrowseClientEventLogger","CommercialBreakMobileEvent","DataAttributeUtils","DOM","FullViewType","MarauderLogger","NonBlockingIFrame","PercentVisible","Style","URI","ViewableImpressionUtils","Visibility","VisibilityState","WebSpeedJSExperiments","csx","ge","getElementPosition","getViewportDimensions","mixInEventEmitter"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B){function C(D,E,F){"use strict";this.id=D;this.element=E;this.config=F;this.iframe=null;this.viewableTimeout=null;this.clearSubsequentTimeout=null;this.waitForSubsequent=false;this.waitForLogged=false;this.isNonViewableLogged=false;this.isVisible=false;this.iframeLogged=false;this.banzaiLogged=false;this.topLeftInViewport=false;this.bottomRightInViewport=false}C.prototype.getID=function(){"use strict";return this.id};C.prototype.getConfig=function(){"use strict";return this.config};C.prototype.getPercentInViewport=function(){"use strict";var D=A(),E=z(this.element);return this.$ViewableImpressionTracker1(D,E)};C.prototype.$ViewableImpressionTracker2=function(D,E){var F=arguments.length<=2||arguments[2]===undefined?0:arguments[2];"use strict";if(E.x<D.width&&E.x+E.width>0&&E.y<D.height&&E.y+E.height>F&&r.get(this.element,"visibility")!=="hidden"&&r.get(this.element,"opacity")!=="0"){var G=Math.max(E.x,0),H=Math.min(E.x+E.width,D.width),I=Math.max(E.y,F),J=Math.min(E.y+E.height,D.height);if(E.height*E.width===0)return 100;var K=100*(H-G)*(J-I)/(E.height*E.width);return K}return 0};C.prototype.$ViewableImpressionTracker1=function(D,E){"use strict";if(this.config.require_horizontally_onscreen&&t.isHorizontallyOffscreen(this.element,E,D))return 0;return this.$ViewableImpressionTracker2(D,E)};C.prototype.$ViewableImpressionTracker3=function(D,E,F){"use strict";var G=this.$ViewableImpressionTracker2(D,E,F);if(G===0)return q.NO_VISIBLE;else if(G<50)return q.VISIBLE_0_PCT;else if(G<100)return q.VISIBLE_50_PCT;else return q.VISIBLE_100_PCT};C.prototype.$ViewableImpressionTracker4=function(D,E){var F=arguments.length<=2||arguments[2]===undefined?0:arguments[2];"use strict";var G=Math.max(E.y,F),H=Math.min(E.y+E.height,D.height),I=100*(H-G)/(D.height-F);if(I<50)return q.VISIBLE_0_PCT;else if(I<100)return q.VISIBLE_50_PCT;else return q.VISIBLE_100_PCT};C.prototype.$ViewableImpressionTracker5=function(D,E){"use strict";var F=0,G=y("pagelet_bluebar");if(G&&G.offsetHeight)F=G.offsetHeight+G.offsetTop;if(this.config.should_log_viewport_duration){var H=this.$ViewableImpressionTracker4(D,E,F);switch(H){case q.VISIBLE_0_PCT:case q.VISIBLE_50_PCT:case q.VISIBLE_100_PCT:this.emit("viewport_viewability",{tracker:this,id:this.getID(),token:this.getToken(),percentVisible:H});break;default:break}}var I=this.$ViewableImpressionTracker3(D,E,F);switch(I){case q.VISIBLE_0_PCT:case q.VISIBLE_50_PCT:case q.VISIBLE_100_PCT:this.emit("viewability",{tracker:this,id:this.getID(),token:this.getToken(),percentVisible:I});break;default:this.emit("hidden",{id:this.getID(),token:this.getToken()});break}};C.prototype.$ViewableImpressionTracker6=function(D,E){"use strict";if(r.get(this.element,"visibility")==="hidden"||r.get(this.element,"opacity")==="0")return false;var F=E.x,G=E.y,H=E.x+E.width,I=E.y+E.height;this.topLeftInViewport=this.topLeftInViewport||F>=0&&F<=D.width&&G>=0&&G<=D.height;this.bottomRightInViewport=this.bottomRightInViewport||H>=0&&H<=D.width&&I>=0&&I<=D.height;return this.topLeftInViewport&&this.bottomRightInViewport};C.prototype.$ViewableImpressionTracker7=function(D,E){"use strict";if(this.hasEmittedFullViewEvent)return;if(this.$ViewableImpressionTracker6(D,E)){this.emit("full_view",{tracker:this,id:this.getID(),token:this.getToken(),fullViewType:n.ENTIRE_UNIT});this.hasEmittedFullViewEvent=true}};C.prototype.$ViewableImpressionTracker8=function(D,E){"use strict";var F=E.y,G=E.y+E.height,H=F>=0&&F<=D.height,I=G>=0&&G<=D.height,J=void 0;if(H&&I)J=v.FULL;else if(H)J=v.TOP;else if(I)J=v.BOTTOM;else J=v.NULL;this.emit("viewability_debug",{tracker:this,id:this.getID(),token:this.getToken(),visibleState:J})};C.prototype.onVisible=function(event){"use strict";this.isVisible=true;var D=A(),E=z(this.element),F=this.$ViewableImpressionTracker1(D,E),G=F>this.config.pixel_in_percentage;this.emit("visible",{tracker:this,id:this.getID(),token:this.getToken(),percentInViewport:F});if(this.config.should_log_viewability_duration)this.$ViewableImpressionTracker5(D,E);if(this.config.should_log_debug_duration)this.$ViewableImpressionTracker8(D,E);this.$ViewableImpressionTracker7(D,E);if(!G){this.$ViewableImpressionTracker9();return}if(this.isLogged())this.$ViewableImpressionTracker10();else this.$ViewableImpressionTracker11();if(!this.waitForLogged&&!this.isLogged()&&!(h.blockInvisible&&u.isHidden())){this.waitForLogged=true;this.viewableTimeout=setTimeout(function(){this.waitForLogged=false;if(h.blockInvisible&&u.isHidden())return;var F=this.getPercentInViewport(),G=F>this.config.pixel_in_percentage;if(!G){this.$ViewableImpressionTracker12();return}this.logImpression(1,{});this.$ViewableImpressionTracker10()}.bind(this),this.config.duration_in_ms)}};C.prototype.onHidden=function(){"use strict";this.emit("hidden",{id:this.getID(),token:this.getToken()});if(this.config.log_initial_nonviewable&&!this.isLogged()&&!this.isNonViewableLogged)this.logNonViewableImpression();else if(!this.config.log_initial_nonviewable&&!this.isLogged()&&this.isVisible)this.logNonViewableImpression();this.isVisible=false;if(this.waitForLogged){this.waitForLogged=false;clearTimeout(this.viewableTimeout)}if(this.isLogged()&&!this.waitForSubsequent&&this.config.subsequent_gap_in_ms>=0){this.waitForSubsequent=true;this.clearSubsequentTimeout=setTimeout(function(){this.waitForSubsequent=false;this.reset();if(this.isVisible)this.onVisible()}.bind(this),this.config.subsequent_gap_in_ms)}this.$ViewableImpressionTracker12()};C.prototype.onRemoved=function(){"use strict";this.isVisible=false};C.prototype.getToken=function(){"use strict";return l.getDataAttribute(this.element,"data-xt")};C.prototype.logImpression=function(D,E){"use strict";if(this.isLogged())return;var F=this.getToken(),G=Math.floor(Date.now()/1e3),H=this.$ViewableImpressionTracker13(),I={xt:F,isv:D,cts:G,csp:H};if(i.isEnabled("xtrackable_clientview_batch")&&this.config.should_batch||this.config.vital_mode_for_ss||this.config.signal_mode_for_ss){var J=this.config.vital_mode_for_ss?i.VITAL:{};J.signal=this.config.signal_mode_for_ss;this.logWithBanzai(I,J)}else this.logWithIFrame(Object.assign(I,E))};C.prototype.logNonViewableImpression=function(){"use strict";if(this.config.nonviewableEnabled){var D=this.getToken();i.post("xtrackable:nonviewable",{xt:D})}this.isNonViewableLogged=true};C.prototype.isLogged=function(){"use strict";return this.iframeLogged||this.banzaiLogged};C.prototype.reset=function(){"use strict";if(this.iframeLogged)this.iframeLogged=false;if(this.iframe){m.remove(this.iframe);this.iframe=null}if(this.banzaiLogged)this.banzaiLogged=false;this.isNonViewableLogged=false;this.isVisible=false;this.waitForLogged=false;this.waitForSubsequent=false};C.prototype.logWithBanzai=function(D,E){"use strict";this.banzaiLogged=true;j.maybeLogClientViewEvent(D);i.post("xtrackable:clientview_batch",D,E)};C.prototype.logWithIFrame=function(D){"use strict";this.iframeLogged=true;if(w.non_blocking_tracker||this.config.is_instream_story)p.loadIFrame(new s(this.config.impressionURL).addQueryData(D).toString());else{this.iframe=m.create("iframe",{src:new s(this.config.impressionURL).addQueryData(D),width:0,height:0,frameborder:0,scrolling:"no",className:"fbEmuTracking"});this.iframe.setAttribute("aria-hidden","true");m.appendContent(this.element,this.iframe)}};C.prototype.$ViewableImpressionTracker13=function(){"use strict";var D=l.getDataAttribute(this.element,"data-dedupekey");if(D===null)return null;var E=this.$ViewableImpressionTracker14();if(E===null||E.length===0)return null;var F=E.length;while(--F>=0){var G=l.getDataAttribute(E[F],"data-dedupekey");if(G!==null&&D===G)break}return F+1};C.prototype.$ViewableImpressionTracker14=function(){"use strict";var D=y("contentArea");if(D){var E="._5jmm",F=m.scry(D,E);return F.filter(function(H){return l.getDataAttribute(H,"data-dedupekey")})}else{var G=y("m_newsfeed_stream");return G===null?null:G.getElementsByTagName("article")}};C.prototype.$ViewableImpressionTracker15=function(){"use strict";return 0};C.prototype.$ViewableImpressionTracker9=function(){"use strict";if(this.$ViewableImpressionTracker15()){r.set(this.element,"background-color","#abab9a");r.set(this.element,"outline","3px solid #abab9a")}};C.prototype.$ViewableImpressionTracker11=function(){"use strict";if(this.$ViewableImpressionTracker15()){r.set(this.element,"background-color","#e4f70a");r.set(this.element,"outline","3px solid #e4f70a")}};C.prototype.$ViewableImpressionTracker12=function(){"use strict";if(this.$ViewableImpressionTracker15()){r.set(this.element,"background-color",null);r.set(this.element,"outline",null)}};C.prototype.$ViewableImpressionTracker10=function(){"use strict";if(this.$ViewableImpressionTracker15()){r.set(this.element,"background-color","#047515");r.set(this.element,"outline","3px solid #047515")}};B(C,{visible:true,hidden:true,full_view:true,viewability:true,viewport_viewability:true,viewability_debug:true});f.exports=C}),null);
__d("ViewabilityDebugLogger",["Banzai","Map","ViewableImpressionTracker","VisibilityState","keyMirror"],(function a(b,c,d,e,f,g,h,i,j,k,l){"use strict";var m=l({top_enter_viewport:null,top_exit_viewport:null,bottom_enter_viewport:null,bottom_exit_viewport:null});n.logFromViewableImpressionTracker=function(o){var p=new n();p.subscribeToTrackerEvents(o)};function n(){this.$ViewabilityDebugLogger1=new i();this.$ViewabilityDebugLogger2=new i();this.$ViewabilityDebugLogger3=new i()}n.prototype.subscribeToTrackerEvents=function(o){o.addListener("viewability_debug",this.onView.bind(this));o.addListener("hidden",this.onHidden.bind(this))};n.prototype.onView=function(event){var o=event.id,p=event.visibleState,q=Date.now(),r=this.$ViewabilityDebugLogger1.get(o),s=this.$ViewabilityDebugLogger2.get(o);switch(p){case k.TOP:if(!this.$ViewabilityDebugLogger1.has(o))this.$ViewabilityDebugLogger4(event,q,k.TOP);if(s){var t={token:s.token,start_ts:s.start_ts,event_type:m.bottom_exit_viewport,event_time:q};this.$ViewabilityDebugLogger5(t,o,k.BOTTOM)}break;case k.FULL:if(!this.$ViewabilityDebugLogger3.has(o))this.$ViewabilityDebugLogger4(event,q,k.FULL);break;case k.BOTTOM:if(!this.$ViewabilityDebugLogger2.has(o))this.$ViewabilityDebugLogger4(event,q,k.BOTTOM);if(r){var u={token:r.token,start_ts:r.start_ts,event_type:m.top_exit_viewport,event_time:q};this.$ViewabilityDebugLogger5(u,o,k.TOP)}break;case k.NULL:if(r){var v={token:r.token,start_ts:r.start_ts,event_type:m.top_exit_viewport,event_time:q};this.$ViewabilityDebugLogger5(v,o,k.TOP)}if(s){var w={token:s.token,start_ts:s.start_ts,event_type:m.bottom_exit_viewport,event_time:q};this.$ViewabilityDebugLogger5(w,o,k.BOTTOM)}}};n.prototype.onHidden=function(event){var o=event.id,p=Date.now(),q=this.$ViewabilityDebugLogger1.get(o),r=this.$ViewabilityDebugLogger2.get(o);if(q){var s={token:q.token,start_ts:q.start_ts,event_type:m.top_exit_viewport,event_time:p};this.$ViewabilityDebugLogger5(s,o,k.TOP)}if(r){var t={token:r.token,start_ts:r.start_ts,event_type:m.bottom_exit_viewport,event_time:p};this.$ViewabilityDebugLogger5(t,o,k.BOTTOM)}};n.prototype.$ViewabilityDebugLogger4=function(event,o,p){var q={token:event.token,start_ts:o,event_time:o};switch(p){case k.TOP:q.event_type=m.top_enter_viewport;this.$ViewabilityDebugLogger1.set(event.id,q);this.$ViewabilityDebugLogger6(q);break;case k.BOTTOM:q.event_type=m.bottom_enter_viewport;this.$ViewabilityDebugLogger2.set(event.id,q);this.$ViewabilityDebugLogger6(q);break;case k.FULL:this.$ViewabilityDebugLogger3.set(event.id,q);if(!this.$ViewabilityDebugLogger1.has(event.id)){var r={token:q.token,start_ts:o,event_time:o,event_type:m.top_enter_viewport};this.$ViewabilityDebugLogger1.set(event.id,r);this.$ViewabilityDebugLogger6(r)}if(!this.$ViewabilityDebugLogger2.has(event.id)){var s={token:q.token,start_ts:o,event_time:o,event_type:m.bottom_enter_viewport};this.$ViewabilityDebugLogger2.set(event.id,s);this.$ViewabilityDebugLogger6(s)}break}};n.prototype.$ViewabilityDebugLogger6=function(o){h.post("xtrackable:viewability_debug",o)};n.prototype.$ViewabilityDebugLogger5=function(o,p,q){h.post("xtrackable:viewability_debug",o);switch(q){case k.BOTTOM:this.$ViewabilityDebugLogger2["delete"](p);break;case k.TOP:this.$ViewabilityDebugLogger1["delete"](p);break}this.$ViewabilityDebugLogger3["delete"](p)};f.exports=n}),null);
__d("VisibilityUnitType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({FEED_UNIT:"feed_unit",VIEWPORT:"viewport"})}),null);
__d("ViewabilityDurationSegmentLogger",["Banzai","Map","PercentVisible","ViewableImpressionTracker","VisibilityUnitType"],(function a(b,c,d,e,f,g,h,i,j,k,l){"use strict";var m=8e3;n.logFromViewableImpressionTracker=function(o){var p=new n();p.subscribeToTrackerEvents(o)};function n(){this.$ViewabilityDurationSegmentLogger1=new i();this.$ViewabilityDurationSegmentLogger2=new i();this.$ViewabilityDurationSegmentLogger3=new i();this.$ViewabilityDurationSegmentLogger4=new i();this.$ViewabilityDurationSegmentLogger5=new i()}n.prototype.subscribeToTrackerEvents=function(o){o.addListener("viewability",this.onViewable.bind(this));o.addListener("viewport_viewability",this.onViewport.bind(this));o.addListener("hidden",this.onHidden.bind(this))};n.prototype.onViewable=function(event){var o=event.id,p=event.percentVisible,q=Date.now(),r=void 0,s=void 0;switch(p){case j.VISIBLE_0_PCT:r=this.$ViewabilityDurationSegmentLogger1.get(o);if(!r)this.$ViewabilityDurationSegmentLogger6(event,j.VISIBLE_0_PCT,q,l.FEED_UNIT);else this.$ViewabilityDurationSegmentLogger7(r,o,q);r=this.$ViewabilityDurationSegmentLogger2.get(o);if(r){s=this.$ViewabilityDurationSegmentLogger8(r,o,q,true);this.$ViewabilityDurationSegmentLogger9(s,o)}r=this.$ViewabilityDurationSegmentLogger4.get(o);if(r){s=this.$ViewabilityDurationSegmentLogger8(r,o,q,true);this.$ViewabilityDurationSegmentLogger9(s,o)}break;case j.VISIBLE_50_PCT:r=this.$ViewabilityDurationSegmentLogger1.get(o);if(!r)this.$ViewabilityDurationSegmentLogger6(event,j.VISIBLE_0_PCT,q,l.FEED_UNIT);else this.$ViewabilityDurationSegmentLogger7(r,o,q);r=this.$ViewabilityDurationSegmentLogger2.get(o);if(!r)this.$ViewabilityDurationSegmentLogger6(event,j.VISIBLE_50_PCT,q,l.FEED_UNIT);else this.$ViewabilityDurationSegmentLogger7(r,o,q);r=this.$ViewabilityDurationSegmentLogger4.get(o);if(r){s=this.$ViewabilityDurationSegmentLogger8(r,o,q,true);this.$ViewabilityDurationSegmentLogger9(s,o)}break;case j.VISIBLE_100_PCT:r=this.$ViewabilityDurationSegmentLogger1.get(o);if(!r)this.$ViewabilityDurationSegmentLogger6(event,j.VISIBLE_0_PCT,q,l.FEED_UNIT);else this.$ViewabilityDurationSegmentLogger7(r,o,q);r=this.$ViewabilityDurationSegmentLogger2.get(o);if(!r)this.$ViewabilityDurationSegmentLogger6(event,j.VISIBLE_50_PCT,q,l.FEED_UNIT);else this.$ViewabilityDurationSegmentLogger7(r,o,q);r=this.$ViewabilityDurationSegmentLogger4.get(o);if(!r)this.$ViewabilityDurationSegmentLogger6(event,j.VISIBLE_100_PCT,q,l.FEED_UNIT);else this.$ViewabilityDurationSegmentLogger7(r,o,q);break}};n.prototype.onViewport=function(event){var o=event.id,p=event.percentVisible,q=Date.now(),r=void 0,s=void 0;switch(p){case j.VISIBLE_0_PCT:r=this.$ViewabilityDurationSegmentLogger3.get(o);if(r){s=this.$ViewabilityDurationSegmentLogger8(r,o,q,true);this.$ViewabilityDurationSegmentLogger9(s,o)}r=this.$ViewabilityDurationSegmentLogger5.get(o);if(r){s=this.$ViewabilityDurationSegmentLogger8(r,o,q,true);this.$ViewabilityDurationSegmentLogger9(s,o)}break;case j.VISIBLE_50_PCT:r=this.$ViewabilityDurationSegmentLogger3.get(o);if(!r)this.$ViewabilityDurationSegmentLogger6(event,j.VISIBLE_50_PCT,q,l.VIEWPORT);else this.$ViewabilityDurationSegmentLogger7(r,o,q);r=this.$ViewabilityDurationSegmentLogger5.get(o);if(r){s=this.$ViewabilityDurationSegmentLogger8(r,o,q,true);this.$ViewabilityDurationSegmentLogger9(s,o)}break;case j.VISIBLE_100_PCT:r=this.$ViewabilityDurationSegmentLogger3.get(o);if(!r)this.$ViewabilityDurationSegmentLogger6(event,j.VISIBLE_50_PCT,q,l.VIEWPORT);else this.$ViewabilityDurationSegmentLogger7(r,o,q);r=this.$ViewabilityDurationSegmentLogger5.get(o);if(!r)this.$ViewabilityDurationSegmentLogger6(event,j.VISIBLE_100_PCT,q,l.VIEWPORT);else this.$ViewabilityDurationSegmentLogger7(r,o,q);break}};n.prototype.onHidden=function(event){var o=event.id,p=Date.now(),q=this.$ViewabilityDurationSegmentLogger1.get(o),r=this.$ViewabilityDurationSegmentLogger2.get(o),s=this.$ViewabilityDurationSegmentLogger3.get(o),t=this.$ViewabilityDurationSegmentLogger4.get(o),u=this.$ViewabilityDurationSegmentLogger5.get(o);if(q)this.$ViewabilityDurationSegmentLogger9(this.$ViewabilityDurationSegmentLogger8(q,o,p,true),o);if(r)this.$ViewabilityDurationSegmentLogger9(this.$ViewabilityDurationSegmentLogger8(r,o,p,true),o);if(s)this.$ViewabilityDurationSegmentLogger9(this.$ViewabilityDurationSegmentLogger8(s,o,p,true),o);if(t)this.$ViewabilityDurationSegmentLogger9(this.$ViewabilityDurationSegmentLogger8(t,o,p,true),o);if(u)this.$ViewabilityDurationSegmentLogger9(this.$ViewabilityDurationSegmentLogger8(u,o,p,true),o)};n.prototype.$ViewabilityDurationSegmentLogger6=function(event,o,p,q){var r={token:event.token,startedTrackingTS:p,percentVisible:o,visibilityUnit:q,intervalMs:0,cumulativeMs:0,segmentIdx:0};switch(o){case j.VISIBLE_0_PCT:this.$ViewabilityDurationSegmentLogger1.set(event.id,r);break;case j.VISIBLE_50_PCT:if(q===l.FEED_UNIT)this.$ViewabilityDurationSegmentLogger2.set(event.id,r);else this.$ViewabilityDurationSegmentLogger3.set(event.id,r);break;case j.VISIBLE_100_PCT:if(q===l.FEED_UNIT)this.$ViewabilityDurationSegmentLogger4.set(event.id,r);else this.$ViewabilityDurationSegmentLogger5.set(event.id,r);break}};n.prototype.$ViewabilityDurationSegmentLogger8=function(o,p,q,r){var s=q-o.startedTrackingTS,t=s-o.cumulativeMs,u=o.percentVisible,v={token:o.token,startedTrackingTS:o.startedTrackingTS,percentVisible:u,visibilityUnit:o.visibilityUnit,intervalMs:t,cumulativeMs:s,segmentIdx:++o.segmentIdx};if(r)v.duration=s;switch(u){case j.VISIBLE_0_PCT:this.$ViewabilityDurationSegmentLogger1.set(p,v);break;case j.VISIBLE_50_PCT:if(o.visibilityUnit===l.FEED_UNIT)this.$ViewabilityDurationSegmentLogger2.set(p,v);else this.$ViewabilityDurationSegmentLogger3.set(p,v);break;case j.VISIBLE_100_PCT:if(o.visibilityUnit===l.FEED_UNIT)this.$ViewabilityDurationSegmentLogger4.set(p,v);else this.$ViewabilityDurationSegmentLogger5.set(p,v);break}return v};n.prototype.$ViewabilityDurationSegmentLogger7=function(o,p,q){var r=o.intervalMs,s=q-o.startedTrackingTS-o.cumulativeMs;if(this.$ViewabilityDurationSegmentLogger10(r,s)){var t=this.$ViewabilityDurationSegmentLogger8(o,p,q,false);h.post("xtrackable:viewability",t,h.VITAL)}};n.prototype.$ViewabilityDurationSegmentLogger10=function(o,p){if(o>=m)return false;if(o==0)return true;if(o<1e3)return p>=1e3;var q=0;q=o/1e3;var r=p/1e3;return r>=2*q};n.prototype.$ViewabilityDurationSegmentLogger9=function(o,p){var q=o.percentVisible;switch(q){case j.VISIBLE_0_PCT:this.$ViewabilityDurationSegmentLogger1["delete"](p);break;case j.VISIBLE_50_PCT:if(o.visibilityUnit===l.FEED_UNIT)this.$ViewabilityDurationSegmentLogger2["delete"](p);else this.$ViewabilityDurationSegmentLogger3["delete"](p);break;case j.VISIBLE_100_PCT:if(o.visibilityUnit===l.FEED_UNIT)this.$ViewabilityDurationSegmentLogger4["delete"](p);else this.$ViewabilityDurationSegmentLogger5["delete"](p);break}h.post("xtrackable:viewability",o,h.VITAL)};f.exports=n}),null);
__d("ViewableImpressionDurationLogger",["Banzai","Map"],(function a(b,c,d,e,f,g,h,i){"use strict";j.logFromViewableImpressionTracker=function(k){var l=new j();l.subscribeToTrackerEvents(k)};function j(){this.$ViewableImpressionDurationLogger1=new i()}j.prototype.subscribeToTrackerEvents=function(k){k.addListener("visible",this.onElementVisible.bind(this));k.addListener("hidden",this.onElementHidden.bind(this))};j.prototype.onElementVisible=function(event){if(this.$ViewableImpressionDurationLogger1.get(event.id))return null;var k={token:event.token,startedTrackingTS:this.getTimeNow()};this.$ViewableImpressionDurationLogger1.set(event.id,k);return k};j.prototype.onElementHidden=function(event){var k=this.$ViewableImpressionDurationLogger1.get(event.id);if(!k)return false;k.trackingDuration=this.getTimeNow()-k.startedTrackingTS;return this.sendLog(event.id)};j.prototype.sendLog=function(k){var l=this.$ViewableImpressionDurationLogger1.get(k);if(!l||!l.trackingDuration)return false;h.post("xtrackable:duration",l);this.$ViewableImpressionDurationLogger1["delete"](k);return true};j.prototype.getTimeNow=function(){return parseFloat((Date.now()/1e3).toFixed(2))};f.exports=j}),null);
__d("ViewableImpressionHeatmapLogger",["Banzai"],(function a(b,c,d,e,f,g,h){i.logFromViewableImpressionTracker=function(j,k){"use strict";var l=new i(k);l.subscribeToTrackerEvents(j)};function i(j){"use strict";this.loggingDurationMS=j;this.trackingEntries={}}i.prototype.subscribeToTrackerEvents=function(j){"use strict";this.visibleSubscription=j.addListener("visible",this.onElementVisible,this);this.hiddenSubscription=j.addListener("hidden",this.onElementHidden,this)};i.prototype.onElementVisible=function(j){"use strict";var k=this.getCurrentTimestamp(),l=this.trackingEntries[j.id];if(!l){l=this.createTrackingEntry(j);this.beginTracking(j.id,l);k=l.startedTrackingTS}l.viewportProgressEvents.push({timestamp:k,percentInViewport:j.percentInViewport.toFixed(2)})};i.prototype.onElementHidden=function(j){"use strict";var k=this.getCurrentTimestamp(),l=this.trackingEntries[j.id];if(!l)return;l.viewportProgressEvents.push({timestamp:k,percentInViewport:0})};i.prototype.onTrackingCompleted=function(j){"use strict";var k=this.trackingEntries[j];k.viewportProgressEvents.push({timestamp:this.getCurrentTimestamp(),percentInViewport:k.tracker.getPercentInViewport().toFixed(2)});if(this.$ViewableImpressionHeatmapLogger1())this.$ViewableImpressionHeatmapLogger2(j,k);this.logToServer(k);delete this.trackingEntries[j]};i.prototype.logToServer=function(j){"use strict";var k=j;delete k.tracker;h.post("xtrackable:heatmap",k)};i.prototype.beginTracking=function(j,k){"use strict";this.trackingEntries[j]=k;setTimeout(function(){return this.onTrackingCompleted(j)}.bind(this),this.loggingDurationMS)};i.prototype.createTrackingEntry=function(j){"use strict";return{tracker:j.tracker,token:j.token,startedTrackingTS:this.getCurrentTimestamp(),viewportProgressEvents:[]}};i.prototype.getCurrentTimestamp=function(){"use strict";return(Date.now()/1e3).toFixed(2)};i.prototype.$ViewableImpressionHeatmapLogger1=function(){"use strict";return 0};i.prototype.$ViewableImpressionHeatmapLogger2=function(j,k){"use strict";var l="Completed tracking for id "+j+" token="+k.token+" startedTrackingTS="+k.startedTrackingTS+"\n";k.viewportProgressEvents.forEach(function(m){l+="% in view: "+m.percentInViewport+" timestamp="+m.timestamp+"\n"})};f.exports=i}),null);
__d("getContextualParent",["ge"],(function a(b,c,d,e,f,g,h){function i(j,k){var l,m=false;do if(j.getAttribute&&(l=j.getAttribute("data-ownerid"))){j=h(l);m=true}else j=j.parentNode;while(k&&j&&!m);return j}f.exports=i}),null);
__d("collectDataAttributes",["DataAttributeUtils","getContextualParent"],(function a(b,c,d,e,f,g,h,i){var j="normal";function k(l,m,n){var o={},p=[],q=m.length,r;for(r=0;r<q;++r){o[m[r]]={};p.push("data-"+m[r])}if(n){o[j]={};for(r=0;r<(n||[]).length;++r)p.push(n[r])}var s={tn:"","tn-debug":","};while(l){if(l.getAttribute)for(r=0;r<p.length;++r){var t=p[r],u=h.getDataAttribute(l,t);if(u){if(r>=q){if(o[j][t]===undefined)o[j][t]=u;continue}var v=JSON.parse(u);for(var w in v)if(s[w]!==undefined){if(o[m[r]][w]===undefined)o[m[r]][w]=[];o[m[r]][w].push(v[w])}else if(o[m[r]][w]===undefined)o[m[r]][w]=v[w]}}l=i(l)}for(var x in o)for(var y in s)if(o[x][y]!==undefined)o[x][y]=o[x][y].join(s[y]);return o}f.exports=k}),null);
__d("VisibilityTracking",["Banzai","BrowseClientEventLogger","DataAttributeUtils","ErrorUtils","ScriptPath","SubscriptionsHandler","Visibility","VisibilityTrackingHelper","collectDataAttributes","getElementPosition","pageID","throttle"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t="visibility_tracking",u="[data-vistracking]",v=500,w=50,x=50,y=50,z=50,A=0;function B(C){"use strict";C=C||{};if(!C.bypass_banzai_check&&!h.isEnabled(t))return;this.visibleElementInfo={};this.getDataFromConfig(C);n.addListener(n.VISIBLE,k.guard(function(){return this.fireEvent("browser")}.bind(this),"VisibilityTracking:visible",this));n.addListener(n.HIDDEN,k.guard(function(){return this.clearAllVisibleElements("browser")}.bind(this),"VisibilityTracking:hidden",this));l.subscribe(k.guard(function(){return this.updateVisibleElements()}.bind(this),"VisibilityTracking:scriptPath",this));h.subscribe(h.SHUTDOWN,k.guard(function(){return this.onUnload()}.bind(this),"VisibilityTracking:banzaiShutdown",this));this.fireEventCallback=s.acrossTransitions(k.guard(function(event){return this.fireEvent(event)}.bind(this),"VisibilityTracking:fireEventCallback",this),this.timeout,this);this.listeners=new m();o.getEventListeners(function(){return this.fireEventCallback()}.bind(this)).forEach(function(D){this.listeners.addSubscriptions(D)},this);if(this.extraInit)k.applyWithGuard(this.extraInit.bind(this))}B.prototype.getDataFromConfig=function(C){"use strict";this.config=C;this.root=C.root||document.documentElement;this.selector=C.selector||u;this.timeout=C.timeout!==undefined?C.timeout:v;this.minOffsetVisibleFromBottom=C.minOffsetVisibleFromBottom!==undefined?C.minOffsetVisibleFromBottom:w;this.minOffsetVisibleFromTop=C.minOffsetVisibleFromTop!==undefined?C.minOffsetVisibleFromTop:x;this.minOffsetVisibleFromLeft=C.minOffsetVisibleFromLeft!==undefined?C.minOffsetVisibleFromLeft:y;this.minOffsetVisibleFromRight=C.minOffsetVisibleFromRight!==undefined?C.minOffsetVisibleFromRight:z;this.handleAllHiddenEvents=C.handleAllHiddenEvents!==undefined?C.handleAllHiddenEvents:false;this.handleAllVisibleEvents=C.handleAllVisibleEvents!==undefined?C.handleAllVisibleEvents:false;this.cacheTrackedElements=C.cacheTrackedElements!==undefined?C.cacheTrackedElements:false};B.prototype.getAllTrackedElements=function(){"use strict";if(!this.allTrackedElements){this.allTrackedElements={};var C=[];if(this.config.is_xtrackable)C=j.getXTrackableElements();else if(this.root&&this.root.querySelectorAll)C=this.root.querySelectorAll(this.selector);for(var D=0;D<C.length;D++){var E=this.getElementID(C[D]);this.allTrackedElements[E.toString()]=C[D]}}return this.allTrackedElements};B.prototype.refreshAllTrackedElements=function(){"use strict";delete this.allTrackedElements;return this.getAllTrackedElements()};B.prototype.getDataToLog=function(C){"use strict";var D=Object.assign(p(C,["gt"]).gt,{client_time:Date.now()/1e3,time_spent_id:r,script_path:l.getScriptPath()});return D};B.prototype.getElementID=function(C){"use strict";var D=C.$VisibilityTracking1;if(D)return D;C.$VisibilityTracking1=++A;return A};B.prototype.sendDataToLog=function(C){"use strict";i.maybeLogVisiblityEvent(C);h.post(t,C)};B.prototype.isInstreamAdStoryElement=function(C){"use strict";return false};B.prototype.fireEvent=function(){var C=arguments.length<=0||arguments[0]===undefined?"default":arguments[0];"use strict";var D=this.cacheTrackedElements?this.allTrackedElements:this.refreshAllTrackedElements();for(var E in D){var F=D[E],G=o.getViewportInfo(),H=this.isVisible(F,G);if(!H&&(E in this.visibleElementInfo||this.handleAllHiddenEvents))this.handleEvent(F,{name:"hidden",cause:C});else if(H&&(!(E in this.visibleElementInfo)||this.handleAllVisibleEvents))this.handleEvent(F,{name:"visible",cause:C})}this.clearUntrackedVisibleElements()};B.prototype.isVisible=function(C,D){"use strict";if(C==null)return false;var E=q(C);return E.y+E.height>=this.minOffsetVisibleFromTop&&E.y<=D.height-this.minOffsetVisibleFromBottom&&E.x+E.width>=this.minOffsetVisibleFromLeft&&E.x<=D.width-this.minOffsetVisibleFromRight};B.prototype.handleEvent=function(C,event){"use strict";var D=this.getElementID(C).toString(),E=this.getDataToLog(C),F=void 0;if(event.name==="visible"){var G=Math.floor(Date.now()/1e3);F=r.concat(":",G.toString(),":",this.getElementID(C).toString());this.visibleElementInfo[D]={visibility_id:F,elem:C}}else if(event.name==="hidden"){if(D in this.visibleElementInfo){F=this.visibleElementInfo[D].visibility_id;delete this.visibleElementInfo[D]}if(event.cause==="browser")return}this.sendDataToLog(Object.assign(E,{event:event.name,visibility_id:F}))};B.prototype.clearUntrackedVisibleElements=function(){"use strict";var C=this.getAllTrackedElements();for(var D in this.visibleElementInfo)if(!(D in C)){var E=this.visibleElementInfo[D];if(E.elem)this.handleEvent(E.elem,{name:"hidden",cause:"removed"})}};B.prototype.clearAllVisibleElements=function(){var C=arguments.length<=0||arguments[0]===undefined?"default":arguments[0];"use strict";var D=this.getAllTrackedElements();for(var E in D)if(E in this.visibleElementInfo)this.handleEvent(D[E],{name:"hidden",cause:C});this.clearUntrackedVisibleElements()};B.prototype.updateVisibleElements=function(){"use strict";this.clearAllVisibleElements();this.fireEvent()};B.prototype.refreshAndFireEvent=function(event){"use strict";this.refreshAllTrackedElements();this.fireEventCallback(event)};B.prototype.onUnload=function(){"use strict";this.clearAllVisibleElements();if(this.listeners){this.listeners.release();this.listeners=null}if(this.extraCleanup)k.applyWithGuard(this.extraCleanup.bind(this))};B.init=function(C){"use strict";return new B(C)};f.exports=B}),null);
__d("ViewableImpressionEventHandler",["DataAttributeUtils","FullViewLogger","ViewabilityDebugLogger","ViewabilityDurationSegmentLogger","ViewableImpressionDurationLogger","ViewableImpressionHeatmapLogger","ViewableImpressionTracker","VisibilityTracking"],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";var p,q,r=1;p=babelHelpers.inherits(s,o);q=p&&p.prototype;s.prototype.extraInit=function(){this.impressionTrackers={}};s.prototype.getDataFromConfig=function(t){q.getDataFromConfig.call(this,t);this.doHeatmapLogging=t.doHeatmapLogging;this.heatmapLoggingDurationMS=t.heatmapLoggingDurationMS;t.impressionURL=t.impressionURL!==undefined?t.impressionURL:"/xti.php";t.nonviewableEnabled=t.nonviewableEnabled!==undefined?t.nonviewableEnabled:false};s.prototype.getImpressionTracking=function(t){var u=this.getElementID(t),v=this.impressionTrackers[u];if(!v){var w=babelHelpers["extends"]({},this.getConfigFromElement(t),this.config);v=new n(u,t,w);this.impressionTrackers[u]=v;if(w.log_impression_duration)l.logFromViewableImpressionTracker(v);if(this.doHeatmapLogging)m.logFromViewableImpressionTracker(v,this.heatmapLoggingDurationMS);if(w.should_log_full_views)i.logFromViewableImpressionTracker(v);if(w.should_log_viewability_duration)k.logFromViewableImpressionTracker(v);if(w.should_log_debug_duration)j.logFromViewableImpressionTracker(v)}return v};s.prototype.handleEvent=function(t,event){var u=this.getImpressionTracking(t);if(!u)return;if(event.name==="visible"){u.onVisible(event);if(!this.visibleElementInfo[u.getID()])this.visibleElementInfo[u.getID()]={elem:t}}else if(event.name==="hidden"){var v=u.getConfig();if(event.cause==="default"||v.log_visibility_hidden_when_browser_inactive&&event.cause==="browser"){u.onHidden();delete this.visibleElementInfo[u.getID()]}else if(event.cause==="removed"){u.onRemoved();delete this.visibleElementInfo[u.getID()];delete this.impressionTrackers[u.getID()]}}};s.prototype.isInstreamAdStoryElement=function(t){var u=babelHelpers["extends"]({},this.getConfigFromElement(t),this.config);return!!u.is_instream_story};s.prototype.getConfigFromElement=function(t){return JSON.parse(h.getDataAttribute(t,"data-xt-vimp"))};s.prototype.getElementID=function(t){if(!t.getAttribute("id"))t.setAttribute("id","xt_uniq_"+r++);return t.getAttribute("id")};function s(){p.apply(this,arguments)}f.exports=s}),null);
__d("MViewableImpressionTracking",["ErrorUtils","Stratcom","ViewableImpressionEventHandler","MViewableImpressionConfig"],(function a(b,c,d,e,f,g,h,i,j,k){var l={init:function m(){if(j.instance===undefined){j.instance=new j(k);i.listen(["m:ajax:complete","m:feed:new-stories-loaded","m:more_item_automatic:items_loaded","m:onload","m-timeline-section-loader:complete","m-timeline-section-loader:init","m:profile:teaser-list:expanded","m:viewport:update-complete"],null,h.guard(function(){if(j.instance===undefined){i.removeCurrentListener();return}j.instance.refreshAndFireEvent()},"MViewableImpressionTracking"));i.listen("m:page:unload",null,h.guard(function(){delete j.instance;j.instance=undefined},"MViewableImpressionTracking"))}}};f.exports=l}),null);